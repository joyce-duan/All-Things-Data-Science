<!DOCTYPE html>
<!--[if IE 7]>
<html id="ie7" lang="en">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en">
<![endif]-->
<!--[if IE 9]>
<html id="ie9" lang="en">
<![endif]-->
<!--[if !(IE 7) | !(IE 8) | !(IE9) ]><!-->
<html lang="en">
<!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Why GEMM is at the heart of deep learning &laquo; Pete Warden&#039;s blog</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="http://petewarden.com/xmlrpc.php" />
<!--[if lt IE 9]>
<script src="https://s0.wp.com/wp-content/themes/premium/elemin/js/html5.js" type="text/javascript"></script>
<![endif]-->
		<script src='https://r-login.wordpress.com/remote-login.php?action=js&amp;host=petewarden.com&amp;id=55065938&amp;t=1435179323&amp;back=http%3A%2F%2Fpetewarden.com%2F2015%2F04%2F20%2Fwhy-gemm-is-at-the-heart-of-deep-learning%2F' type="text/javascript"></script>
		<script type="text/javascript">
		/* <![CDATA[ */
			if ( 'function' === typeof WPRemoteLogin ) {
				document.cookie = "wordpress_test_cookie=test; path=/";
				if ( document.cookie.match( /(;|^)\s*wordpress_test_cookie\=/ ) ) {
					WPRemoteLogin();
				}
			}
		/* ]]> */
		</script>
		<link rel="alternate" type="application/rss+xml" title="Pete Warden&#039;s blog &raquo; Feed" href="http://petewarden.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Pete Warden&#039;s blog &raquo; Comments Feed" href="http://petewarden.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Pete Warden&#039;s blog &raquo; Why GEMM is at the heart of deep&nbsp;learning Comments Feed" href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
function addLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!='function'){window.onload=func;}else{window.onload=function(){oldonload();func();}}}
/* ]]> */
</script>
<link rel='stylesheet' id='all-css-0' href='https://s0.wp.com/_static/??-eJx9j1muwjAMRTf08izEIPhArKVNTUixa6t2VbF7UgYhBvXH8rXO0U1g1BClc+wceAhKQ8qdgXEmvGgvLUZ/T//R7A9+a5TPaNCiaxXP4Za+8JokvQRJCRsZPByFSEYYc5NwtqNHqhyboGL+kea0KD2WO2vlE8HY5AoJuWBzGuvmaU3rqfxrtmbUQoe61h7NQpmcBw5+KkXf3v0MDwqm5+QOzC+EE3vg/WK1XK03u+1y3V4B5CKgiQ==' type='text/css' media='all' />
<link rel='stylesheet' id='sorts-mill-goudy-css'  href='http://fonts.googleapis.com/css?family=Sorts+Mill+Goudy%3Aregular%2Citalic&#038;ver=20120821' type='text/css' media='all' />
<link rel='stylesheet' id='all-css-2' href='https://s0.wp.com/_static/??-eJx9i1EKgCAQRC+ULVIUfURnKTFZ0V1Jo+tnCFEQ/QxvmHlwBKGYkqYEfhfB7QYpgvZssWStYqwAgThhfsYbyvDtG83CsZoTMr2KWN2M25+66cWxyWggvx71kiY/yrZph66RvbQnboFFvA==' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-3' href='https://s0.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1387483371g' type='text/css' media='print' />
<link rel='stylesheet' id='all-css-4' href='https://s0.wp.com/_static/??-eJx1izsOgCAQBS8krh/UyngWNCtgYCEsxuurhZVazUvmDRxRLIEyUga/i+h2bYkhBs5idcomYKOSJf2wXJgL+K40EiZ7iZ/5arNBjwxGgnZhVu4+TH6sZSurrm+6YTsBJUk66g==' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var LoggedOutFollow = {"invalid_email":"Your subscription did not succeed, please try again with a valid email address."};
/* ]]> */
</script>
<script type='text/javascript' src='https://s2.wp.com/_static/??-eJyFj2kKAjEMhS9kLbP4UzzLLJma2s02tejpzYAjOA4KgWzfC3myBIFuMHmEJDXHNUO8v9Jep538BQiLKnYEe4tugQfvCBzNrPU9GhA5QewUz/jQ5De44BNZSImhje3nS+huCOUvpoFCN1xEhISPr6u98UoEkxW6JLlWMPpMYvLG+CILjgporbH5rYhg2PQo5r9X3VpFZ2BnMkSwmK0Ew9ktnhk+2WPVNs2hqtu61U+OTJVN'></script>
<link rel='stylesheet' id='all-css-0' href='https://s2.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1377793621g' type='text/css' media='all' />
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s2.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563g&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://petewarden.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Give Bay Area girls a head-start in&nbsp;tech' href='http://petewarden.com/2015/03/12/give-bay-area-girls-a-head-start-in-tech/' />
<link rel='next' title='Why you should visit the Living Computer Museum in&nbsp;Seattle' href='http://petewarden.com/2015/04/26/why-you-should-visit-the-living-computer-museum-in-seattle/' />
<meta name="generator" content="WordPress.com" />
<link rel='canonical' href='http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/' />
<link rel='shortlink' href='http://wp.me/p3J3ai-1vo' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&amp;url=http%3A%2F%2Fpetewarden.com%2F2015%2F04%2F20%2Fwhy-gemm-is-at-the-heart-of-deep-learning%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&amp;url=http%3A%2F%2Fpetewarden.com%2F2015%2F04%2F20%2Fwhy-gemm-is-at-the-heart-of-deep-learning%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Why GEMM is at the heart of deep learning" />
<meta property="og:url" content="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/" />
<meta property="og:description" content="Photo by Anthony Catalano I spend most of my time worrying about how to make deep learning with neural networks faster and more power efficient. In practice that means focusing on a function called..." />
<meta property="article:published_time" content="2015-04-20T00:20:17+00:00" />
<meta property="article:modified_time" content="2015-04-21T02:33:10+00:00" />
<meta property="og:site_name" content="Pete Warden&#039;s blog" />
<meta property="og:image" content="https://petewarden.files.wordpress.com/2015/04/im2colmult_corrected1.png" />
<meta property="og:image" content="https://petewarden.files.wordpress.com/2015/04/gemm_corrected.png" />
<meta property="og:image" content="https://petewarden.files.wordpress.com/2015/04/fcgemm_corrected.png" />
<meta property="og:image" content="https://petewarden.files.wordpress.com/2015/04/im2col_corrected.png" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:image" content="https://petewarden.files.wordpress.com/2015/04/seventiessuits.png?w=240" />
<meta name="twitter:card" content="summary" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<link rel="shortcut icon" type="image/x-icon" href="http://0.gravatar.com/blavatar/e77445cc56791209fe2e4bf971830686?s=16" sizes="16x16" />
<link rel="icon" type="image/x-icon" href="http://0.gravatar.com/blavatar/e77445cc56791209fe2e4bf971830686?s=16" sizes="16x16" />
<link rel="apple-touch-icon-precomposed" href="http://0.gravatar.com/blavatar/2a5ea0aa5e124914d42d11730ea93ab8?s=114" />
<link rel='openid.server' href='http://petewarden.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='http://petewarden.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="http://petewarden.com/osd.xml" title="Pete Warden&#039;s blog" />
<link rel="search" type="application/opensearchdescription+xml" href="https://wordpress.com/opensearch.xml" title="WordPress.com" />
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="Pete Warden&#039;s blog" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="Ever tried. Ever failed. No matter. Try Again. Fail again. Fail better." /><meta name="msapplication-task" content="name=Subscribe;action-uri=http://petewarden.com/feed/;icon-uri=http://0.gravatar.com/blavatar/e77445cc56791209fe2e4bf971830686?s=16" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="title" content="Why GEMM is at the heart of deep&nbsp;learning | Pete Warden&#039;s blog on WordPress.com" />
<meta name="description" content="Photo by Anthony Catalano I spend most of my time worrying about how to make deep learning with neural networks faster and more power efficient. In practice that means focusing on a function called GEMM. It&#039;s part of the BLAS (Basic Linear Algebra Subprograms) library that was first created in 1979, and until I started&hellip;" />
<style type="text/css" id="syntaxhighlighteranchor"></style>
		<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s0.wp.com/?custom-css=1&#038;csblog=3J3ai&#038;cscache=6&#038;csrev=2" />
		</head>

<body class="single single-post postid-5790 single-format-standard mp6 typekit-enabled customizer-styles-applied content-sidebar elemin-columns-one highlander-enabled highlander-light">


<div id="page" class="hfeed one-col-posts">
		<header id="branding" role="banner">

		<div class="header-search-form">	<form method="get" id="searchform" action="http://petewarden.com/">
		<label for="s" class="assistive-text">Search</label>
		<input type="text" class="field" name="s" id="s" placeholder="Search" />
		<input type="submit" class="submit" name="submit" id="searchsubmit" value="Search" />
	</form>
</div>

		<hgroup>
			<h1 id="site-title"><a href="http://petewarden.com/" title="Pete Warden&#039;s blog" rel="home">Pete Warden&#039;s blog</a></h1>
			<h2 id="site-description">Ever tried. Ever failed. No matter. Try Again. Fail again. Fail better.</h2>
		</hgroup>

		<nav id="access" class="clearfix" role="navigation">
			<h1 class="assistive-text section-heading">Main menu</h1>
			<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
			<div class="menu"><ul><li ><a href="http://petewarden.com/">Home</a></li><li class="page_item page-item-1"><a href="http://petewarden.com/about/">About</a></li></ul></div>
		</nav><!-- #access -->
	</header><!-- #branding -->

	<div id="main" class="clearfix">
		<div id="primary">
			<div id="content" role="main">

			
				
<article id="post-5790" class="clearfix post-5790 post type-post status-publish format-standard hentry category-uncategorized">

	<header class="entry-header">
		<div class="post-format-icon"><a href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/" title="Permalink to Why GEMM is at the heart of deep&nbsp;learning" rel="bookmark"></a></div>
					<h1 class="entry-title">Why GEMM is at the heart of deep&nbsp;learning</h1>
			</header><!-- .entry-header -->

	<div class="entry-meta">
		<span class="entry-date"><a href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/" title="April 20, 2015" rel="bookmark">April 20, 2015</a></span> <span class="byline"> <span class="sep"> By </span> <span class="author vcard"><a class="url fn n" href="http://petewarden.com/author/petewarden/" title="View all posts by Pete Warden" rel="author">Pete Warden</a></span></span> <span class="entry-categories">in <a href="http://petewarden.com/category/uncategorized/" rel="category tag">Uncategorized</a></span>				<span class="comments-link"><a href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/#comments">6 Comments</a></span>
					</div><!-- #entry-meta -->

	<div class="post-content">
		<div class="entry-content">
						<p><a href="https://www.flickr.com/photos/badwsky/2139850690/in/photolist-4g6i4q-6vNYCx-9L7GMN-dvygKf-pgwy8E-6kvYtC-5ZB71E-huyTph-47wmM6-6Eg3Fd-67Z4RC-8Q5s4X-3camqf-3cami9-huz1A1-8Q5sWk-vQndM-7SyNrD-8Q8zMf-8Q8zdb-8Q5s1P-8Q8zHj-3daZHT-8Q8z95-8Q8yWJ-doGTcK-7XSRsZ-7W3Akz-huyhr3-47wqcH-8Q8zeE-mF3TC-4uPhTY-FCz46-6kvYzJ-3owuG-68E2ei-5vzh9t-hknp7w-3iJfCq-2Rtb1G-H2vb5-huzVkt-huysN5-huyjoQ-huy8dH-6EdJkL-47wrnc-47AwqN-47AwhJ"><img class="alignnone size-large wp-image-5791" src="https://petewarden.files.wordpress.com/2015/04/seventiessuits.png?w=550&#038;h=713" alt="seventiessuits"   /></a></p>
<p><a href="https://www.flickr.com/photos/badwsky/2139850690/in/photolist-4g6i4q-6vNYCx-9L7GMN-dvygKf-pgwy8E-6kvYtC-5ZB71E-huyTph-47wmM6-6Eg3Fd-67Z4RC-8Q5s4X-3camqf-3cami9-huz1A1-8Q5sWk-vQndM-7SyNrD-8Q8zMf-8Q8zdb-8Q5s1P-8Q8zHj-3daZHT-8Q8z95-8Q8yWJ-doGTcK-7XSRsZ-7W3Akz-huyhr3-47wqcH-8Q8zeE-mF3TC-4uPhTY-FCz46-6kvYzJ-3owuG-68E2ei-5vzh9t-hknp7w-3iJfCq-2Rtb1G-H2vb5-huzVkt-huysN5-huyjoQ-huy8dH-6EdJkL-47wrnc-47AwqN-47AwhJ"><em>Photo by Anthony Catalano</em></a></p>
<p>I spend most of my time worrying about how to make deep learning with neural networks faster and more power efficient. In practice that means focusing on a function called GEMM. It&#8217;s part of the BLAS (Basic Linear Algebra Subprograms) library that was <a href="http://www.cs.utexas.edu/users/kincaid/blas.pdf">first created in 1979</a>, and until I started trying to optimize neural networks I&#8217;d never heard of it. To explain why it&#8217;s so important, here&#8217;s a diagram from my friend <a href="http://daggerfs.com/">Yangqing Jia&#8217;s</a> <a href="http://www.eecs.berkeley.edu/Pubs/TechRpts/2014/EECS-2014-93.pdf">thesis</a>:</p>
<p><a href="http://www.eecs.berkeley.edu/Pubs/TechRpts/2014/EECS-2014-93.pdf"><img class="alignnone size-large wp-image-5792" src="https://petewarden.files.wordpress.com/2015/04/profile.png?w=550&#038;h=204" alt="profile"   /></a></p>
<p>This is breaking down where the time&#8217;s going for a typical deep convolutional neural network doing image recognition using Alex Krizhevsky&#8217;s Imagenet architecture. All of the layers that start with fc (for fully-connected) or conv (for convolution) are implemented using GEMM, and almost all the time (95% of the GPU version, and 89% on CPU) is spent on those layers.</p>
<p>So what is GEMM? It stands for GEneral Matrix to Matrix Multiplication, and it essentially does exactly what it says on the tin, multiplies two input matrices together to get an output one. The difference between it and the kind of matrix operations I was used to in the 3D graphics world is that the matrices it works on are often very big. For example, a single layer in a typical network may require the multiplication of a 256 row, 1,152 column matrix by an 1,152 row, 192 column matrix to produce a 256 row, 192 column result. Naively, that requires 57 million (256 x 1,152, x 192) floating point operations and there can be dozens of these layers in a modern architecture, so I often see networks that need several billion FLOPs to calculate a single frame. Here&#8217;s a diagram that I sketched to help me visualize how it works:</p>
<p><a href="https://petewarden.files.wordpress.com/2015/04/gemm_corrected.png"><img class="alignnone size-large wp-image-5806" src="https://petewarden.files.wordpress.com/2015/04/gemm_corrected.png?w=550&#038;h=226" alt="gemm_corrected"   /></a></p>
<h2>Fully-Connected Layers</h2>
<p>Fully-connected layers are the classic neural networks that have been around for decades, and it&#8217;s probably easiest to start with how GEMM is usedfor those. Each output value of an FC layer looks at every value in the input layer, multiplies them all by the corresponding weight it has for that input index, and sums the results to get its output. In terms of the diagram above, it looks like this:</p>
<p><a href="https://petewarden.files.wordpress.com/2015/04/fcgemm_corrected.png"><img class="alignnone size-large wp-image-5805" src="https://petewarden.files.wordpress.com/2015/04/fcgemm_corrected.png?w=550&#038;h=182" alt="fcgemm_corrected"   /></a></p>
<p>There are &#8216;k&#8217; input values, and there are &#8216;n&#8217; neurons, each one of which has its own set of learned weights for every input value. There are &#8216;n&#8217; output values, one for each neuron, calculated by doing a dot product of its weights and the input values.</p>
<h2>Convolutional Layers</h2>
<p>Using GEMM for the convolutional layers is a lot less of an obvious choice. A conv layer treats its input as a two dimensional image, with a number of channels for each pixel, much like a classical image with width, height, and depth. Unlike the images I was used to dealing with though, the number of channels can be in the hundreds, rather than just RGB or RGBA!</p>
<p>The convolution operation produces its output by taking a number of &#8216;kernels&#8217; of weights. and applying them across the image. Here&#8217;s what an input image and a single kernel look like:</p>
<p><a href="https://petewarden.files.wordpress.com/2015/04/kernelview.png"><img class="alignnone size-large wp-image-5796" src="https://petewarden.files.wordpress.com/2015/04/kernelview.png?w=550&#038;h=278" alt="kernelview"   /></a></p>
<p>Each kernel is another three-dimensional array of numbers, with the depth the same as the input image, but with a much smaller width and height, typically something like 7&#215;7. To produce a result, a kernel is applied to a grid of points across the input image. At each point where it&#8217;s applied, all of the corresponding input values and weights are multiplied together, and then summed to produce a single output value at that point. Here&#8217;s what that looks like visually:</p>
<p><a href="https://petewarden.files.wordpress.com/2015/04/patches1.png"><img class="alignnone size-large wp-image-5798" src="https://petewarden.files.wordpress.com/2015/04/patches1.png?w=550&#038;h=281" alt="patches"   /></a></p>
<p>You can think of this operation as something like an edge detector. The kernel contains a pattern of weights, and when the part of the input image it&#8217;s looking at has a similar pattern it outputs a high value. When the input doesn&#8217;t match the pattern, the result is a low number in that position. Here are some typical patterns that are learned by the first layer of a network, courtesy of the awesome <a href="http://caffe.berkeleyvision.org/">Caffe</a> and <a href="http://devblogs.nvidia.com/parallelforall/deep-learning-computer-vision-caffe-cudnn/">featured on the NVIDIA blog</a>:</p>
<p><a href="http://devblogs.nvidia.com/parallelforall/deep-learning-computer-vision-caffe-cudnn/"><img class="alignnone size-large wp-image-5799" src="https://petewarden.files.wordpress.com/2015/04/kernels.png?w=550&#038;h=539" alt="kernels"   /></a></p>
<p>Because the input to the first layer is an RGB image, all of these kernels can be visualized as RGB too, and they show the primitive patterns that the network is looking for. Each one of these 96 kernels is applied in a grid pattern across the input, and the result is a series of 96 two-dimensional arrays, which are treated as an output image with a depth of 96 channels. If you&#8217;re used to image processing operations like the Sobel operator, you can probably picture how each one of these is a bit like an edge detector optimized for different important patterns in the image, and so each channel is a map of where those patterns occur across the input.</p>
<p>You may have noticed that I&#8217;ve been vague about what kind of grid the kernels are applied in. The key controlling factor for this is a parameter called &#8216;stride&#8217;, which defines the spacing between the kernel applications. For example, with a stride of 1, a 256&#215;256 input image would have a kernel applied at every pixel, and the output would be the same width and height as the input. With a stride of 4, that same input image would only have kernels applied every four pixels, so the output would only be 64&#215;64. Typical stride values are less than the size of a kernel, which means that in the diagram visualizing the kernel application, a lot of them would actually overlap at the edges.</p>
<h2>How GEMM works for Convolutions</h2>
<p>This seems like quite a specialized operation. It involves a lot of multiplications and summing at the end, like the fully-connected layer, but it&#8217;s not clear how or why we should turn this into a matrix multiplication for the GEMM. I&#8217;ll talk about the motivation at the end, but here&#8217;s how the operation is expressed in terms of a matrix multiplication.</p>
<p>The first step is to turn the input from an image, which is effectively a 3D array, into a 2D array that we can treat like a matrix. Where each kernel is applied is a little three-dimensional cube within the image, and so we take each one of those cubes of input values and copy them out as a single column into a matrix. This is known as im2col, for image-to-column, I believe from an original Matlab function, and here&#8217;s how I visualize it:</p>
<p><a href="https://petewarden.files.wordpress.com/2015/04/im2col_corrected.png"><img class="alignnone size-large wp-image-5804" src="https://petewarden.files.wordpress.com/2015/04/im2col_corrected.png?w=550&#038;h=252" alt="im2col_corrected"   /></a></p>
<p>Now if you&#8217;re an image-processing geek like me, you&#8217;ll probably be appalled at the expansion in memory size that happens when we do this conversion if the stride is less than the kernel size. This means that pixels that are included in overlapping kernel sites will be duplicated in the matrix, which seems inefficient. You&#8217;ll have to trust me that this wastage is outweighed by the advantages though.</p>
<p>Now you have the input image in matrix form, you do the same for each kernel&#8217;s weights, serializing the 3D cubes into rows as the second matrix for the multiplication. Here&#8217;s what the final GEMM looks like:</p>
<p><a href="https://petewarden.files.wordpress.com/2015/04/im2colmult_corrected1.png"><img class="alignnone size-large wp-image-5807" src="https://petewarden.files.wordpress.com/2015/04/im2colmult_corrected1.png?w=550&#038;h=331" alt="im2colmult_corrected"   /></a></p>
<p>Here &#8216;k&#8217; is the number of values in each patch and kernel, so it&#8217;s kernel width * kernel height * depth. The resulting matrix is &#8216;Number of patches&#8217; columns high, by &#8216;Number of kernel&#8217; rows wide. This matrix is actually treated as a 3D array by subsequent operations, by taking the number of kernels dimension as the depth, and then splitting the patches back into rows and columns based on their original position in the input image.</p>
<h2>Why GEMM works for Convolutions</h2>
<p>Hopefully you can now see how you can express a convolutional layer as a matrix multiplication, but it&#8217;s still not obvious why you would do it. The short answer is that it turns out that the Fortran world of scientific programmers has spent decades optimizing code to perform large matrix to matrix multiplications, and the benefits from the very regular patterns of memory access outweigh the wasteful storage costs. <a href="http://arxiv.org/pdf/1410.0759.pdf">This paper from Nvidia</a> is a good introduction to some of the different approaches you can use, but they also describe why they ended up with a modified version of GEMM as their favored approach. There are also a lot of advantages to being able to batch up a lot of input images against the same kernels at once, and this <a href="http://arxiv.org/pdf/1504.04343v1.pdf">paper on Caffe con troll</a>uses those to very good effect. The main competitor to the GEMM approach is using Fourier transforms to do the operation in frequency space, but the use of strides in our convolutions makes it hard to be as efficient.</p>
<p>The good news is that having a single, well-understood function taking up most of our time gives a very clear path to optimizing for speed and power usage, both with better software implementations and by tailoring the hardware to run the operation well. Because deep networks have proven to be useful for a massive range of applications across speech, NLP, and computer vision, I&#8217;m looking forward to seeing massive improvements over the next few years, much like the widespread demand for 3D games drove a revolution in GPUs by forcing a revolution in vertex and pixel processing operations.</p>
<p><em>(Updated to fix my incorrect matrix ordering in the diagrams, apologies to anyone who was confused!)</em></p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-5790" class="share-twitter sd-button share-icon" href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-5790" class="share-facebook sd-button share-icon" href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/?share=facebook" target="_blank" title="Share on Facebook"><span>Facebook</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-5790" class="share-google-plus-1 sd-button share-icon" href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/?share=google-plus-1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-55065938-5790-558b193ba235e' data-src='//widgets.wp.com/likes/#blog_id=55065938&amp;post_id=5790&amp;origin=petewarden.wordpress.com&amp;obj_id=55065938-5790-558b193ba235e' data-name='like-post-frame-55065938-5790-558b193ba235e'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height:55px'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>					</div><!-- .entry-content -->
	</div><!-- .post-content -->

</article><!-- #post-5790 -->
					<nav id="nav-below" class="clearfix">
		<h1 class="assistive-text section-heading">Post navigation</h1>

	
		<div class="nav-previous"><a href="http://petewarden.com/2015/03/12/give-bay-area-girls-a-head-start-in-tech/" rel="prev"><span class="meta-nav">&laquo;</span> Give Bay Area girls a head-start in&nbsp;tech</a></div>		<div class="nav-next"><a href="http://petewarden.com/2015/04/26/why-you-should-visit-the-living-computer-museum-in-seattle/" rel="next">Why you should visit the Living Computer Museum in&nbsp;Seattle <span class="meta-nav">&raquo;</span></a></div>
	
	</nav><!-- #nav-below -->
	
					<div id="comments">
	
	
			<h3 id="comments-title">
			6 responses		</h3>

		
		<ol class="commentlist">
				<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-79996">
		<article id="comment-79996" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt='' src='http://2.gravatar.com/avatar/54f70981ce3758ccbfd5420bbff28df6?s=60&#038;d=identicon&#038;r=G' class='avatar avatar-60' height='60' width='60' />					<cite class="fn">Zygmunt</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/comment-page-1/#comment-79996"><time pubdate datetime="2015-04-20T12:26:47+00:00">
					April 20, 2015 at 12:26 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Correct me if I&#8217;m wrong, but on the first diagram:<br />
k x m  *  n x k  !=  n x m</p>
<p>You need<br />
n x k  *  k x m  =  n x m</p>
</div>

			<div class="reply">
				<a class='comment-reply-link' href='/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/?replytocom=79996#respond' onclick='return addComment.moveForm( "comment-79996", "79996", "respond", "5790" )' aria-label='Reply to Zygmunt'>Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-80040">
		<article id="comment-80040" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt='' src='http://0.gravatar.com/avatar/fa7d357635526bfe948c67f9889198a1?s=60&#038;d=identicon&#038;r=G' class='avatar avatar-60' height='60' width='60' />					<cite class="fn"><a href='http://www.nervanasys.com/' rel='external nofollow' class='url'>Scott Gray</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/comment-page-1/#comment-80040"><time pubdate datetime="2015-04-21T06:55:02+00:00">
					April 21, 2015 at 6:55 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>I thought this might be a good place to outline my approach.  You can find the numbers I&#8217;m getting here (NervanaSys):</p>
<p><a href="https://github.com/soumith/convnet-benchmarks" rel="nofollow">https://github.com/soumith/convnet-benchmarks</a></p>
<p>These are basically full utilization on the Maxwell GPU.</p>
<p>I&#8217;ll use parameters defined here:</p>
<p><a href="http://arxiv.org/pdf/1410.0759.pdf" rel="nofollow">http://arxiv.org/pdf/1410.0759.pdf</a></p>
<p>So instead of thinking of convolution as a problem of one large gemm operation, it&#8217;s actually much more efficient as many small gemms.  To compute a large gemm on a GPU you need to break it up into many small tiles anyway.  So rather than waste time duplicating your data into a large matrix, you can just start doing small gemms right away directly on the data.  Let the L2 cache do the duplication for you.  </p>
<p>So each small matrix multiply is just one position of the filter over the image.  The outer dims of this MM are N and K and CRS is reduced.  To load in the image data you you need to slice the image as you are carrying out the reduction of outer products.  This is most easily achieved if N is the contiguous dimension of your image data.  This way a single pixel offset applies to a whole row of data and can be efficiently fetched all at once.  The best way to calculate that offset is to first build a small lookup table of all the spatial offsets.  The channel offset can be added after each lookup.  This keeps your lookup table small and easy to fit in fast shared memory.</p>
<p>So to manage all these small MM operations you utilize all three cuda blockIdx values.  I pack the output feature map coordinates (p,q) into the blockIdx.x index.  Then I can use integer division to extract the individual p,q values.  Magic numbers can be computed on the host for this and passed as parameters.   Then in blockIdx y and z I put the normal matrix tiling x and y coordinates.  These are small matrices, but they still typically need to be tiled within this small MM operation.  I use this particular assignment of blockIdx values to maximize L2 cache usage.</p>
<p>Lastly the kernel itself I use to compute the gemm is one designed for a large MM operation.  This gives you the highest ILP and lowest bandwidth requirements.  I wrote my own assembler to be able put all this custom slicing logic into a highly efficient kernel modeled after the ones found in Nvidia&#8217;s cublas (though mine is in fact a bit faster).  You can find the full write-up on that here:</p>
<p><a href="https://github.com/NervanaSystems/maxas/wiki/SGEMM" rel="nofollow">https://github.com/NervanaSystems/maxas/wiki/SGEMM</a></p>
<p>Andrew Lavin also discovered this same approach in parallel with me, though I was about a month ahead of him and had already finished all three convolution operations by the time he released his fprop.  But he does have an excellent write-up going into some additional depth.  He uses constant memory instead of a shared memory lookup.  This is faster but doesn&#8217;t support padding.  Though I understand he may now have figured that out.  If so, we&#8217;ll likely merge kernels at some point.  Here is his write-up and source (my source will be released soon):</p>
<p><a href="https://github.com/eBay/maxDNN" rel="nofollow">https://github.com/eBay/maxDNN</a></p>
<p>-Scott</p>
</div>

			<div class="reply">
				<a class='comment-reply-link' href='/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/?replytocom=80040#respond' onclick='return addComment.moveForm( "comment-80040", "80040", "respond", "5790" )' aria-label='Reply to Scott Gray'>Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="pingback">
		<p>Pingback: <a href='http://advanceddataanalytics.net/2015/04/21/distilled-news-74/' rel='external nofollow' class='url'>Distilled News | Data Analytics &amp; R</a></p>
	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-cpuguy even thread-even depth-1 highlander-comment" id="li-comment-80055">
		<article id="comment-80055" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt='' src='http://1.gravatar.com/avatar/793a2cacb4a5e25419e908948d6b30aa?s=60&#038;d=identicon&#038;r=G' class='avatar avatar-60' height='60' width='60' />					<cite class="fn"><a href='http://cpuguy.wordpress.com' rel='external nofollow' class='url'>cpuguy</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/comment-page-1/#comment-80055"><time pubdate datetime="2015-04-21T10:53:31+00:00">
					April 21, 2015 at 10:53 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Nice paper highlighting the importance of high performance linear algebra</p>
</div>

			<div class="reply">
				<a class='comment-reply-link' href='/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/?replytocom=80055#respond' onclick='return addComment.moveForm( "comment-80055", "80055", "respond", "5790" )' aria-label='Reply to cpuguy'>Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-yteng odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-80069">
		<article id="comment-80069" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt='' src='http://0.gravatar.com/avatar/0197256461c27e19ff9987e9c917ddd5?s=60&#038;d=identicon&#038;r=G' class='avatar avatar-60' height='60' width='60' />					<cite class="fn">T</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/comment-page-1/#comment-80069"><time pubdate datetime="2015-04-21T15:13:00+00:00">
					April 21, 2015 at 3:13 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>The illustration of the matrix multiplication made it really clear1 Also thanks for introducing me to Caffee.</p>
</div>

			<div class="reply">
				<a class='comment-reply-link' href='/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/?replytocom=80069#respond' onclick='return addComment.moveForm( "comment-80069", "80069", "respond", "5790" )' aria-label='Reply to T'>Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="pingback">
		<p>Pingback: <a href='http://petewarden.com/2015/05/23/why-are-eight-bits-enough-for-deep-neural-networks/' rel='external nofollow' class='url'>Why are Eight Bits Enough for Deep Neural Networks? &laquo; Pete Warden&#039;s blog</a></p>
	</li><!-- #comment-## -->
		</ol>

		
	
							<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://petewarden.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																										


												<input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="bf32cc05c2" /><input type="hidden" name="_wp_http_referer" value="/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/" />
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest" />

<div class="comment-form-field comment-textarea">
	<label for="comment">Enter your comment here...</label>
	<div id="comment-form-comment"><textarea id="comment" name="comment" title="Enter your comment here..."></textarea></div>
</div>

<div id="comment-form-identity">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="http://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Gravatar" width="25" class="no-grav" />
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="text" value="" /></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://s2.wp.com/wp-content/mu-plugins/highlander-comments/images/wplogo.png" alt="WordPress.com Logo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="" />
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="http://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Twitter picture" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" />
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="http://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Facebook photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" />
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="http://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Google+ photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="" />
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" tabindex="6"/> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p><p class="post-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;" tabindex="7"/> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog"  style="display: inline;">Notify me of new posts via email.</label></p></div>

						
						<p class="form-submit"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='5790' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="f5c8bca76f" /></p>
<input type="hidden" name="genseq" value="1435179323" />
<p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="24"/></p>					</form>
							</div><!-- #respond -->
			<div style="clear: both"></div>
</div><!-- #comments -->

			
			</div><!-- #content -->
		</div><!-- #primary -->


		<div id="secondary" class="widget-area" role="complementary">
						<aside id="twitter_timeline-2" class="widget widget_twitter_timeline"><h1 class="widget-title">Follow @petewarden on Twitter</h1><a class="twitter-timeline" data-widget-id="355757972368007168" data-theme="light" data-link-color="#f96e5b" data-border-color="#e8e8e8" width="225" height="400" lang="EN">My Tweets</a></aside><aside id="rss_links-2" class="widget widget_rss_links"><ul><li><a href="http://petewarden.com/feed/" title="Subscribe to Posts">RSS - Posts</a></li></ul>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="http://petewarden.com/2015/05/31/why-i-support-at-the-crossroads/">Why I support At the&nbsp;Crossroads</a>
						</li>
					<li>
				<a href="http://petewarden.com/2015/05/23/why-are-eight-bits-enough-for-deep-neural-networks/">Why are Eight Bits Enough for Deep Neural&nbsp;Networks?</a>
						</li>
					<li>
				<a href="http://petewarden.com/2015/05/18/jetpacs-deep-learning-framework-on-the-beaglebone-black/">Jetpac&#8217;s deep learning framework on the Beaglebone&nbsp;Black</a>
						</li>
					<li>
				<a href="http://petewarden.com/2015/05/10/image-recognition-on-the-raspberry-pi-2/">Image Recognition on the Raspberry Pi&nbsp;2</a>
						</li>
					<li>
				<a href="http://petewarden.com/2015/04/26/why-you-should-visit-the-living-computer-museum-in-seattle/">Why you should visit the Living Computer Museum in&nbsp;Seattle</a>
						</li>
				</ul>
		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h1 class="widget-title">Recent Comments</h1>				<table class="recentcommentsavatar" cellspacing="0" cellpadding="0" border="0">
					<tr><td title="Junlong Liu" class="recentcommentsavatartop" style="height:48px; width:48px;"><img alt='' src='http://1.gravatar.com/avatar/796abba9e1941480f8b90e328a04e8bb?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></td><td class="recentcommentstexttop" style="">Junlong Liu on <a href="http://petewarden.com/2015/05/23/why-are-eight-bits-enough-for-deep-neural-networks/comment-page-1/#comment-84056">Why are Eight Bits Enough for&hellip;</a></td></tr><tr><td title="Stitf" class="recentcommentsavatarend" style="height:48px; width:48px;"><img alt='' src='http://2.gravatar.com/avatar/b2774573540634a8c55c76c618b15032?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></td><td class="recentcommentstextend" style="">Stitf on <a href="http://petewarden.com/2014/10/05/why-nerd-culture-must-die/comment-page-2/#comment-83702">Why nerd culture must&nbsp;die</a></td></tr><tr><td title="Brad" class="recentcommentsavatarend" style="height:48px; width:48px;"><a href="http://gravatar.com/baytes" rel="nofollow"><img alt='' src='http://2.gravatar.com/avatar/58a40fef0dac2463df050e5238dd7773?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></a></td><td class="recentcommentstextend" style=""><a href="http://gravatar.com/baytes" rel="nofollow">Brad</a> on <a href="http://petewarden.com/2014/07/25/setting-up-caffe-on-ubuntu-14-04/comment-page-1/#comment-83642">Setting up Caffe on Ubuntu&hellip;</a></td></tr><tr><td title="5 Reasons Guest Blogging Could Save Your Reputation - Tweak Your Biz" class="recentcommentsavatarend" style="height:48px; width:48px;"><a href="http://tweakyourbiz.com/marketing/2015/06/15/5-reasons-guest-blogging-save-reputation/" rel="nofollow"></a></td><td class="recentcommentstextend" style=""><a href="http://tweakyourbiz.com/marketing/2015/06/15/5-reasons-guest-blogging-save-reputation/" rel="nofollow">5 Reasons Guest Blog&hellip;</a> on <a href="http://petewarden.com/2013/09/26/how-many-people-read-my-posts/comment-page-1/#comment-83622">How many people read my&nbsp;p&hellip;</a></td></tr><tr><td title="Mike Cole" class="recentcommentsavatarend" style="height:48px; width:48px;"><img alt='' src='http://2.gravatar.com/avatar/b6032551461ca51e2b9f4483cdfa351a?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></td><td class="recentcommentstextend" style="">Mike Cole on <a href="http://petewarden.com/2014/07/25/setting-up-caffe-on-ubuntu-14-04/comment-page-1/#comment-83619">Setting up Caffe on Ubuntu&hellip;</a></td></tr>				</table>
				</aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
	<li><a href='http://petewarden.com/2015/05/'>May 2015</a></li>
	<li><a href='http://petewarden.com/2015/04/'>April 2015</a></li>
	<li><a href='http://petewarden.com/2015/03/'>March 2015</a></li>
	<li><a href='http://petewarden.com/2015/01/'>January 2015</a></li>
	<li><a href='http://petewarden.com/2014/12/'>December 2014</a></li>
	<li><a href='http://petewarden.com/2014/11/'>November 2014</a></li>
	<li><a href='http://petewarden.com/2014/10/'>October 2014</a></li>
	<li><a href='http://petewarden.com/2014/09/'>September 2014</a></li>
	<li><a href='http://petewarden.com/2014/08/'>August 2014</a></li>
	<li><a href='http://petewarden.com/2014/07/'>July 2014</a></li>
	<li><a href='http://petewarden.com/2014/06/'>June 2014</a></li>
	<li><a href='http://petewarden.com/2014/05/'>May 2014</a></li>
	<li><a href='http://petewarden.com/2014/04/'>April 2014</a></li>
	<li><a href='http://petewarden.com/2014/03/'>March 2014</a></li>
	<li><a href='http://petewarden.com/2014/02/'>February 2014</a></li>
	<li><a href='http://petewarden.com/2014/01/'>January 2014</a></li>
	<li><a href='http://petewarden.com/2013/12/'>December 2013</a></li>
	<li><a href='http://petewarden.com/2013/11/'>November 2013</a></li>
	<li><a href='http://petewarden.com/2013/10/'>October 2013</a></li>
	<li><a href='http://petewarden.com/2013/09/'>September 2013</a></li>
	<li><a href='http://petewarden.com/2013/08/'>August 2013</a></li>
	<li><a href='http://petewarden.com/2013/07/'>July 2013</a></li>
	<li><a href='http://petewarden.com/2013/06/'>June 2013</a></li>
	<li><a href='http://petewarden.com/2013/05/'>May 2013</a></li>
	<li><a href='http://petewarden.com/2013/04/'>April 2013</a></li>
	<li><a href='http://petewarden.com/2013/03/'>March 2013</a></li>
	<li><a href='http://petewarden.com/2013/02/'>February 2013</a></li>
	<li><a href='http://petewarden.com/2013/01/'>January 2013</a></li>
	<li><a href='http://petewarden.com/2012/11/'>November 2012</a></li>
	<li><a href='http://petewarden.com/2012/10/'>October 2012</a></li>
	<li><a href='http://petewarden.com/2012/08/'>August 2012</a></li>
	<li><a href='http://petewarden.com/2012/07/'>July 2012</a></li>
	<li><a href='http://petewarden.com/2012/06/'>June 2012</a></li>
	<li><a href='http://petewarden.com/2012/05/'>May 2012</a></li>
	<li><a href='http://petewarden.com/2012/04/'>April 2012</a></li>
	<li><a href='http://petewarden.com/2012/03/'>March 2012</a></li>
	<li><a href='http://petewarden.com/2012/02/'>February 2012</a></li>
	<li><a href='http://petewarden.com/2012/01/'>January 2012</a></li>
	<li><a href='http://petewarden.com/2011/12/'>December 2011</a></li>
	<li><a href='http://petewarden.com/2011/11/'>November 2011</a></li>
	<li><a href='http://petewarden.com/2011/10/'>October 2011</a></li>
	<li><a href='http://petewarden.com/2011/09/'>September 2011</a></li>
	<li><a href='http://petewarden.com/2011/08/'>August 2011</a></li>
	<li><a href='http://petewarden.com/2011/07/'>July 2011</a></li>
	<li><a href='http://petewarden.com/2011/06/'>June 2011</a></li>
	<li><a href='http://petewarden.com/2011/05/'>May 2011</a></li>
	<li><a href='http://petewarden.com/2011/04/'>April 2011</a></li>
	<li><a href='http://petewarden.com/2011/03/'>March 2011</a></li>
	<li><a href='http://petewarden.com/2011/02/'>February 2011</a></li>
	<li><a href='http://petewarden.com/2011/01/'>January 2011</a></li>
	<li><a href='http://petewarden.com/2010/12/'>December 2010</a></li>
	<li><a href='http://petewarden.com/2010/11/'>November 2010</a></li>
	<li><a href='http://petewarden.com/2010/10/'>October 2010</a></li>
	<li><a href='http://petewarden.com/2010/09/'>September 2010</a></li>
	<li><a href='http://petewarden.com/2010/08/'>August 2010</a></li>
	<li><a href='http://petewarden.com/2010/07/'>July 2010</a></li>
	<li><a href='http://petewarden.com/2010/06/'>June 2010</a></li>
	<li><a href='http://petewarden.com/2010/05/'>May 2010</a></li>
	<li><a href='http://petewarden.com/2010/04/'>April 2010</a></li>
	<li><a href='http://petewarden.com/2010/03/'>March 2010</a></li>
	<li><a href='http://petewarden.com/2010/02/'>February 2010</a></li>
	<li><a href='http://petewarden.com/2010/01/'>January 2010</a></li>
	<li><a href='http://petewarden.com/2009/12/'>December 2009</a></li>
	<li><a href='http://petewarden.com/2009/11/'>November 2009</a></li>
	<li><a href='http://petewarden.com/2009/10/'>October 2009</a></li>
	<li><a href='http://petewarden.com/2009/09/'>September 2009</a></li>
	<li><a href='http://petewarden.com/2009/08/'>August 2009</a></li>
	<li><a href='http://petewarden.com/2009/07/'>July 2009</a></li>
	<li><a href='http://petewarden.com/2009/06/'>June 2009</a></li>
	<li><a href='http://petewarden.com/2009/05/'>May 2009</a></li>
	<li><a href='http://petewarden.com/2009/04/'>April 2009</a></li>
	<li><a href='http://petewarden.com/2009/03/'>March 2009</a></li>
	<li><a href='http://petewarden.com/2009/02/'>February 2009</a></li>
	<li><a href='http://petewarden.com/2009/01/'>January 2009</a></li>
	<li><a href='http://petewarden.com/2008/12/'>December 2008</a></li>
	<li><a href='http://petewarden.com/2008/11/'>November 2008</a></li>
	<li><a href='http://petewarden.com/2008/10/'>October 2008</a></li>
	<li><a href='http://petewarden.com/2008/09/'>September 2008</a></li>
	<li><a href='http://petewarden.com/2008/08/'>August 2008</a></li>
	<li><a href='http://petewarden.com/2008/07/'>July 2008</a></li>
	<li><a href='http://petewarden.com/2008/06/'>June 2008</a></li>
	<li><a href='http://petewarden.com/2008/05/'>May 2008</a></li>
	<li><a href='http://petewarden.com/2008/04/'>April 2008</a></li>
	<li><a href='http://petewarden.com/2008/03/'>March 2008</a></li>
	<li><a href='http://petewarden.com/2008/02/'>February 2008</a></li>
	<li><a href='http://petewarden.com/2008/01/'>January 2008</a></li>
	<li><a href='http://petewarden.com/2007/12/'>December 2007</a></li>
	<li><a href='http://petewarden.com/2007/11/'>November 2007</a></li>
	<li><a href='http://petewarden.com/2007/10/'>October 2007</a></li>
	<li><a href='http://petewarden.com/2007/09/'>September 2007</a></li>
	<li><a href='http://petewarden.com/2007/08/'>August 2007</a></li>
	<li><a href='http://petewarden.com/2007/07/'>July 2007</a></li>
	<li><a href='http://petewarden.com/2007/06/'>June 2007</a></li>
	<li><a href='http://petewarden.com/2007/05/'>May 2007</a></li>
	<li><a href='http://petewarden.com/2007/04/'>April 2007</a></li>
	<li><a href='http://petewarden.com/2007/03/'>March 2007</a></li>
	<li><a href='http://petewarden.com/2006/12/'>December 2006</a></li>
	<li><a href='http://petewarden.com/2006/11/'>November 2006</a></li>
	<li><a href='http://petewarden.com/2006/10/'>October 2006</a></li>
	<li><a href='http://petewarden.com/2006/09/'>September 2006</a></li>
	<li><a href='http://petewarden.com/2006/08/'>August 2006</a></li>
		</ul>
</aside>		</div><!-- #secondary .widget-area -->
	</div><!-- #main -->

	<footer id="colophon" role="contentinfo">

		
		<div id="footer-info">
			<h3 id="footer-title">
				<a href="http://petewarden.com/" title="Pete Warden&#039;s blog" rel="home">Pete Warden&#039;s blog</a>
			</h3>

			<nav id="access-footer" class="clearfix" role="navigation">
				<h1 class="assistive-text section-heading">Footer menu</h1>
				<div class="menu"><ul><li ><a href="http://petewarden.com/">Home</a></li><li class="page_item page-item-1"><a href="http://petewarden.com/about/">About</a></li></ul></div>
			</nav><!-- #access -->
		</div><!-- #footer-info -->

		<div id="site-generator">
			<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com</a>.<span class="sep"> | </span><a href="https://wordpress.com/themes/elemin/" title="Learn more about this theme">The Elemin Theme</a>. Design by <a href="http://themify.me/" rel="designer">Themify</a>.		</div>

		<div id="top-link">
			<a href="#page">&uarr;</a>
		</div><!-- .top-link -->

	</footer><!-- #colophon -->
</div><!-- #page -->

<!-- wpcom_wp_footer -->
		<script type="text/javascript">
			!function(d,s,id){
				var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';
				if(!d.getElementById(id)){
					js=d.createElement(s);
					js.id=id;js.src=p+"://platform.twitter.com/widgets.js";
					fjs.parentNode.insertBefore(js,fjs);
				}
			}(document,"script","twitter-wjs");
		</script>
		<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201526x'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781g'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-54f70981ce3758ccbfd5420bbff28df6">
	</div>
	<div class="grofile-hash-map-fa7d357635526bfe948c67f9889198a1">
	</div>
	<div class="grofile-hash-map-793a2cacb4a5e25419e908948d6b30aa">
	</div>
	<div class="grofile-hash-map-0197256461c27e19ff9987e9c917ddd5">
	</div>
	<div class="grofile-hash-map-796abba9e1941480f8b90e328a04e8bb">
	</div>
	<div class="grofile-hash-map-b2774573540634a8c55c76c618b15032">
	</div>
	<div class="grofile-hash-map-58a40fef0dac2463df050e5238dd7773">
	</div>
	<div class="grofile-hash-map-b6032551461ca51e2b9f4483cdfa351a">
	</div>
	</div>
<script type='text/javascript'>
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/petewarden.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/petewarden.wordpress.com\/wp-login.php?action=logout&_wpnonce=e09f8a9d26","homeURL":"http:\/\/petewarden.com\/","postID":"5790","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"","userIsLoggedIn":"","isJetpack":"0","text_direction":"ltr"};
/* ]]> */
</script>
<script type='text/javascript' src='https://s2.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1424115551j'></script>

	<div id="bit" class="loggedout-follow-normal">
		<a class="bsub" href="javascript:void(0)"><span id='bsub-text'>Follow</span></a>
		<div id="bitsubscribe">

					<h3><label for="loggedout-follow-field">Follow &ldquo;Pete Warden&#039;s blog&rdquo;</label></h3>

			<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="loggedout-follow">
			<p>Get every new post delivered to your Inbox.</p>

			<p id="loggedout-follow-error" style="display: none;"></p>

						<p class="bit-follow-count">Join 1,220 other followers</p>
			<p><input type="email" name="email" value="Enter your email address" onfocus='this.value=(this.value=="Enter your email address") ? "" : this.value;' onblur='this.value=(this.value=="") ? "Enter your email address" : this.value;'  id="loggedout-follow-field"/></p>

			<input type="hidden" name="action" value="subscribe"/>
			<input type="hidden" name="blog_id" value="55065938"/>
			<input type="hidden" name="source" value="http://petewarden.com/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/"/>
			<input type="hidden" name="sub-type" value="loggedout-follow"/>

			<input type="hidden" id="_wpnonce" name="_wpnonce" value="198033d27c" /><input type="hidden" name="_wp_http_referer" value="/2015/04/20/why-gemm-is-at-the-heart-of-deep-learning/" />
			<p id='bsub-subscribe-button'><input type="submit" value="Sign me up" /></p>
			</form>
					<div id='bsub-credit'><a href="https://wordpress.com/?ref=lof">Build a website with WordPress.com</a></div>
		</div><!-- #bitsubscribe -->
	</div><!-- #bit -->

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"http:\/\/petewarden.com\/2015\/04\/20\/why-gemm-is-at-the-heart-of-deep-learning\/":5790};
		window.WPCOM_jetpack = false;
				window.WPCOM_site_ID = 55065938;
			</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
				<iframe src='http://widgets.wp.com/likes/master.html?ver=20141028#ver=20141028&amp;mp6=1' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script type="text/javascript">
		//<![CDATA[
			var jetpackLikesWidgetQueue = [];
			var jetpackLikesWidgetBatch = [];
			var jetpackLikesMasterReady = false;

			function JetpackLikespostMessage( message, target ) {
				if ( "string" === typeof message ){
					try{
						message = JSON.parse( message );
					}
					catch(e) {
						return;
					}
				}

				pm( {
					target: target,
					type: 'likesMessage',
					data: message,
					origin: '*'
				} );
			}

			function JetpackLikesBatchHandler() {
				var requests = [];
				jQuery( 'div.jetpack-likes-widget-unloaded' ).each( function( i ) {
					if ( jetpackLikesWidgetBatch.indexOf( this.id ) > -1 )
						return;
					jetpackLikesWidgetBatch.push( this.id );
					var regex = /like-(post|comment)-wrapper-(\d+)-(\d+)-(\w+)/;
					var match = regex.exec( this.id );
					if ( ! match || match.length != 5 )
						return;

					var info = {
						blog_id: match[2],
						width:   this.width
					};

					if ( 'post' == match[1] ) {
						info.post_id = match[3];
					} else if ( 'comment' == match[1] ) {
						info.comment_id = match[3];
					}

					info.obj_id = match[4];

					requests.push( info );
				});

				if ( requests.length > 0 ) {
					JetpackLikespostMessage( { event: 'initialBatch', requests: requests }, window.frames['likes-master'] );
				}
			}

			function JetpackLikesMessageListener( event ) {
				if ( "undefined" == typeof event.event )
					return;

				if ( 'masterReady' == event.event ) {
					jQuery( document ).ready( function() {
						jetpackLikesMasterReady = true;

						var stylesData = {
								event: 'injectStyles'
						};

						if ( jQuery( 'iframe.admin-bar-likes-widget' ).length > 0 ) {
							JetpackLikespostMessage( { event: 'adminBarEnabled' }, window.frames[ 'likes-master' ] );

							stylesData.adminBarStyles = {
								background: jQuery( '#wpadminbar .quicklinks li#wp-admin-bar-wpl-like > a' ).css( 'background' ),
								isRtl: ( 'rtl' == jQuery( '#wpadminbar' ).css( 'direction' ) )
							};
						}

						if ( !window.addEventListener )
							jQuery( '#wp-admin-bar-admin-bar-likes-widget' ).hide();

						stylesData.textStyles = {
							color: jQuery( '.sd-text-color').css( 'color' ),
							fontFamily: jQuery( '.sd-text-color' ).css( 'font-family' ),
							fontSize: jQuery( '.sd-text-color' ).css( 'font-size' ),
							direction: jQuery( '.sd-text-color' ).css( 'direction' ),
							fontWeight: jQuery( '.sd-text-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-text-color' ).css( 'font-style' ),
							textDecoration: jQuery( '.sd-text-color' ).css('text-decoration')
						};

						stylesData.linkStyles = {
							color: jQuery( '.sd-link-color' ).css('color'),
							fontFamily: jQuery( '.sd-link-color' ).css('font-family'),
							fontSize: jQuery( '.sd-link-color' ).css('font-size'),
							textDecoration: jQuery( '.sd-link-color' ).css('text-decoration'),
							fontWeight: jQuery( '.sd-link-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-link-color' ).css( 'font-style' )
						};

						JetpackLikespostMessage( stylesData, window.frames[ 'likes-master' ] );

						JetpackLikesBatchHandler();

						jQuery( document ).on( 'inview', 'div.jetpack-likes-widget-unloaded', function() {
							jetpackLikesWidgetQueue.push( this.id );
						});
					});
				}

				if ( 'showLikeWidget' == event.event ) {
					jQuery( '#' + event.id + ' .post-likes-widget-placeholder'  ).fadeOut( 'fast', function() {
						jQuery( '#' + event.id + ' .post-likes-widget' ).fadeIn( 'fast', function() {
							JetpackLikespostMessage( { event: 'likeWidgetDisplayed', blog_id: event.blog_id, post_id: event.post_id, obj_id: event.obj_id }, window.frames['likes-master'] );
						});
					});
				}

				if ( 'clickReblogFlair' == event.event ) {
					wpcom_reblog.toggle_reblog_box_flair( event.obj_id );
				}

				if ( 'showOtherGravatars' == event.event ) {
					var $container = jQuery( '#likes-other-gravatars' );
					var $list = $container.find( 'ul' );

					$container.hide();
					$list.html( '' );

					$container.find( '.likes-text span' ).text( event.total );

					jQuery.each( event.likers, function( i, liker ) {
						$list.append( '<li class="' + liker.css_class + '"><a href="' + liker.profile_URL + '" class="wpl-liker" rel="nofollow" target="_parent"><img src="' + liker.avatar_URL + '" alt="' + liker.name + '" width="30" height="30" style="padding-right: 3px;" /></a></li>');
					} );

					var offset = jQuery( "[name='" + event.parent + "']" ).offset();

					$container.css( 'left', offset.left + event.position.left - 10 + 'px' );
					$container.css( 'top', offset.top + event.position.top - 33 + 'px' );

					var rowLength = Math.floor( event.width / 37 );
					var height = ( Math.ceil( event.likers.length / rowLength ) * 37 ) + 13;
					if ( height > 204 ) {
						height = 204;
					}

					$container.css( 'height', height + 'px' );
					$container.css( 'width', rowLength * 37 - 7 + 'px' );

					$list.css( 'width', rowLength * 37 + 'px' );

					$container.fadeIn( 'slow' );

					var scrollbarWidth = $list[0].offsetWidth - $list[0].clientWidth;
					if ( scrollbarWidth > 0 ) {
						$container.width( $container.width() + scrollbarWidth );
						$list.width( $list.width() + scrollbarWidth );
					}
				}
			}

			pm.bind( 'likesMessage', function(e) { JetpackLikesMessageListener(e); } );

			jQuery( document ).click( function( e ) {
				var $container = jQuery( '#likes-other-gravatars' );

				if ( $container.has( e.target ).length === 0 ) {
					$container.fadeOut( 'slow' );
				}
			});

			function JetpackLikesWidgetQueueHandler() {
				var wrapperID;
				if ( ! jetpackLikesMasterReady ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				if ( jetpackLikesWidgetQueue.length > 0 ) {
					// We may have a widget that needs creating now
					var found = false;
					while( jetpackLikesWidgetQueue.length > 0 ) {
						// Grab the first member of the queue that isn't already loading.
						wrapperID = jetpackLikesWidgetQueue.splice( 0, 1 )[0];
						if ( jQuery( '#' + wrapperID ).hasClass( 'jetpack-likes-widget-unloaded' ) ) {
							found = true;
							break;
						}
					}
					if ( ! found ) {
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				} else if ( jQuery( 'div.jetpack-likes-widget-unloaded' ).length > 0 ) {
					// Grab any unloaded widgets for a batch request
					JetpackLikesBatchHandler();

					// Get the next unloaded widget
					wrapperID = jQuery( 'div.jetpack-likes-widget-unloaded' ).first()[0].id;
					if ( ! wrapperID ) {
						// Everything is currently loaded
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				}

				if ( 'undefined' === typeof wrapperID ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				var $wrapper = jQuery( '#' + wrapperID );
				$wrapper.find( 'iframe' ).remove();

				if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='22px' width='68px' frameBorder='0' scrolling='no' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				} else {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='55px' width='100%' frameBorder='0' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				}

				$wrapper.removeClass( 'jetpack-likes-widget-unloaded' ).addClass( 'jetpack-likes-widget-loading' );

				$wrapper.find( 'iframe' ).load( function( e ) {
					var $iframe = jQuery( e.target );
					$wrapper.removeClass( 'jetpack-likes-widget-loading' ).addClass( 'jetpack-likes-widget-loaded' );

					JetpackLikespostMessage( { event: 'loadLikeWidget', name: $iframe.attr( 'name' ), width: $iframe.width() }, window.frames[ 'likes-master' ] );

					if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
						$wrapper.find( 'iframe' ).Jetpack( 'resizeable' );
					}
				});
				setTimeout( JetpackLikesWidgetQueueHandler, 250 );
			}
			JetpackLikesWidgetQueueHandler();
		//]]>
		</script>
<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/akismet-3.0/_inc/form.js?m=1404442431g'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var JetpackEmojiSettings = {"base_url":"http:\/\/s0.wp.com\/wp-content\/mu-plugins\/emoji\/twemoji\/"};
/* ]]> */
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://s1.wp.com/_static/??-eJyNyzsSwjAMRdEN4YhPAhXDWjKOCDKWrbHsBHaPKVxQheoV9zxYxdgYMoYMTmHChSzKq3O6g5ooWF8m1G+zkbkyk1D8u2MKDbU/FyO+zBQUkKMjyOvPbnqHWUb7NP/pLSVRs7n7kRLoY0wU5rb1dOProT/1++F8HC7uA5RkYPM='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script src="//stats.wp.com/w.js?47" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'55065938','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'55065938','v':'wpcom','tz':'0','user_id':'0','post':'5790','subd':'petewarden'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGRVYVNrSFguN3FwSmQ5RGtNX3VQcj1yVzhiflM1THQtLGFdQ2toOXYlNU1DQ1YxbDBNdGUzaTliUEZ+bGgrW216VGVkJkRqLmxnXU9MU2txT3VJMnwyQ3lUdTB5TlkzU0ViZHMvLnVNV3k1MTZFendXTH5jPThRWVldY09wOVgzRUhVP11fQXAvXWJlW29iSTREb0clbnFydmlKWl9KV08rbnlqTUgvSm0tL1t0bzdEP0JTeD8scFNLV3pkWlJrX3V8Q25deEExTVNTQyUwL1MtbTN2el1CbkVfSnRjTzVHVnpULi9Md1dlMkZWLyxOUEMmOCZFZ0RnVj9OWExRUS43JTd+aGtNOUpBT2VHJlMySUFNbEZPXVVbZFFjRFosUmRrcm5OMD9IU01pT0g3azg5QmZIJmI='}]);
_stq.push([ 'clickTrackerInit', '55065938', '5790' ]);
	</script>
<noscript><img src="http://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>
<!--
	generated 169 seconds ago
	generated in 0.500 seconds
	served from batcache in 0.002 seconds
	expires in 131 seconds
-->
